<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebApplication">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- Primary Meta Tags -->
  <title>Bathroom Configurator - Free Bathroom Planning & Procurement Tool</title>
  <meta name="title" content="Bathroom Configurator - Free Bathroom Planning & Procurement Tool">
  <meta name="description" content="Free bathroom configurator tool to plan, compare, and procure bathroom fittings. Compare multiple design options, track costs, generate procurement lists, and export reports. Perfect for homeowners, contractors, and interior designers.">
  <meta name="keywords" content="bathroom configurator, bathroom planning, bathroom design, procurement tool, bathroom renovation, compare bathroom fittings, bathroom cost calculator, free bathroom planner">
  <meta name="author" content="Pooja Sengupta">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://xtra-commerce.github.io/bathroom-configurator/">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://xtra-commerce.github.io/bathroom-configurator/">
  <meta property="og:title" content="Bathroom Configurator - Free Bathroom Planning Tool">
  <meta property="og:description" content="Plan, compare, and procure bathroom fittings with ease. Free tool for homeowners, contractors, and designers.">
  <meta property="og:image" content="https://xtra-commerce.github.io/bathroom-configurator/og-image.png">
  <meta property="og:site_name" content="Bathroom Configurator">
  
  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://xtra-commerce.github.io/bathroom-configurator/">
  <meta property="twitter:title" content="Bathroom Configurator - Free Bathroom Planning Tool">
  <meta property="twitter:description" content="Plan, compare, and procure bathroom fittings with ease. Free tool for homeowners, contractors, and designers.">
  <meta property="twitter:image" content="https://xtra-commerce.github.io/bathroom-configurator/og-image.png">
  
  <!-- Schema.org Structured Data for AI/LLM -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Bathroom Configurator",
    "applicationCategory": "DesignApplication",
    "description": "Free bathroom planning and procurement tool. Compare multiple bathroom design options, track costs across products, generate procurement lists, and export PDF and Excel reports. Features auto-save, currency support, bulk editing, and custom categories.",
    "url": "https://xtra-commerce.github.io/bathroom-configurator/",
    "author": {
      "@type": "Person",
      "name": "Pooja Sengupta"
    },
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "featureList": [
      "Compare multiple bathroom design options",
      "Product database management",
      "Cost tracking and calculation",
      "Procurement list generation",
      "PDF and Excel export",
      "Auto-save functionality",
      "Multi-currency support",
      "Bulk editing",
      "Custom categories",
      "Bathroom render/photo uploads"
    ],
    "screenshot": "https://xtra-commerce.github.io/bathroom-configurator/screenshot.png",
    "softwareVersion": "2.0",
    "operatingSystem": "Web Browser",
    "browserRequirements": "Requires JavaScript, supports React 18"
  }
  </script>
  
  <!-- AI/LLM Optimization -->
  <meta name="application-name" content="Bathroom Configurator">
  <meta name="theme-color" content="#3b82f6">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Bathroom Config">
  
  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üöø</text></svg>">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- StatCounter Analytics -->
  <script type="text/javascript">
  var sc_project=13201711; 
  var sc_invisible=1; 
  var sc_security="a9cc5825"; 
  </script>
  <script type="text/javascript" src="https://www.statcounter.com/counter/counter.js" async></script>
  <noscript>
    <div class="statcounter">
      <a title="Web Analytics" href="https://statcounter.com/" target="_blank">
        <img class="statcounter" src="https://c.statcounter.com/13201711/0/a9cc5825/1/" alt="Web Analytics" referrerPolicy="no-referrer-when-downgrade">
      </a>
    </div>
  </noscript>
</head>
<body>
  <div id="root"></div>
  
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <script>
    function initApp() {
      if (typeof React === 'undefined' || typeof ReactDOM === 'undefined' || typeof Babel === 'undefined') {
        setTimeout(initApp, 50);
        return;
      }
      
      const jsxCode = document.getElementById('app-jsx').textContent;
      
      try {
        const compiled = Babel.transform(jsxCode, { presets: ['react'] }).code;
        eval(compiled);
      } catch (error) {
        console.error('Error:', error);
        document.getElementById('root').innerHTML = 
          '<div style="padding:40px;max-width:900px;margin:0 auto;font-family:sans-serif;">' +
          '<h1 style="color:#dc2626;font-size:28px;margin-bottom:20px;">‚ö†Ô∏è Error Loading App</h1>' +
          '<div style="background:#fef2f2;border:2px solid #fecaca;border-radius:8px;padding:20px;">' +
          '<pre style="margin:0;white-space:pre-wrap;word-wrap:break-word;font-size:14px;">' + 
          error.message + 
          '</pre></div>' +
          '</div>';
      }
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initApp);
    } else {
      initApp();
    }
  </script>
  
  <script id="app-jsx" type="text/template">
const { useState, useEffect, useMemo } = React;

// Simple icon components to replace lucide-react
const Upload = () => <span>üì§</span>;
const Download = () => <span>üì•</span>;
const AlertCircle = () => <span>‚ö†Ô∏è</span>;
const Save = () => <span>üíæ</span>;
const RefreshCw = () => <span>üîÑ</span>;

// We'll load jsPDF dynamically when needed
const loadJsPDF = async () => {
  if (window.jsPDF) return window.jsPDF;
  
  return new Promise((resolve, reject) => {
    const script = document.createElement('script');
    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
    script.onload = () => resolve(window.jspdf.jsPDF);
    script.onerror = reject;
    document.head.appendChild(script);
  });
};

const App = () => {
  const [view, setView] = useState('database');
  const [items, setItems] = useState([]);
  const [bathrooms, setBathrooms] = useState([]);
  const [selectedBathroom, setSelectedBathroom] = useState(null);
  const [showPrices, setShowPrices] = useState(true);
  const [finalSelections, setFinalSelections] = useState({});
  const [log, setLog] = useState([]);
  const [storageAvailable, setStorageAvailable] = useState(true);
  const [showIntro, setShowIntro] = useState(false);

  // Form state
  const [brand, setBrand] = useState('');
  const [model, setModel] = useState('');
  const [category, setCategory] = useState('basin');
  const [series, setSeries] = useState('');
  const [description, setDescription] = useState('');
  const [type, setType] = useState('');
  const [price, setPrice] = useState('');
  const [imageUrl, setImageUrl] = useState('');
  const [editingId, setEditingId] = useState(null);
  const [filterCat, setFilterCat] = useState('all');
  const [deleteConfirm, setDeleteConfirm] = useState(null);
  const [uploadedImage, setUploadedImage] = useState(null);
  const [bulkEditMode, setBulkEditMode] = useState(false);
  const [selectedItems, setSelectedItems] = useState([]);
  const [showBulkEditPanel, setShowBulkEditPanel] = useState(false);
  const [deleteConfirmOption, setDeleteConfirmOption] = useState(null); // For option deletion confirmation
  const [notification, setNotification] = useState(null); // For success/error messages
  const [relatedItems, setRelatedItems] = useState(''); // For product dependencies
  const [customCategories, setCustomCategories] = useState([]); // User-defined categories
  const [currency, setCurrency] = useState('‚Çπ'); // Currency symbol
  const [currencyCode, setCurrencyCode] = useState('INR'); // Currency code
  const [showCurrencySetup, setShowCurrencySetup] = useState(false); // Show currency selection on first load
  const [showCategoryManager, setShowCategoryManager] = useState(false); // Show category manager modal

  // Default categories with zones
  const getDefaultCategories = () => {
    const defaults = [
      // Basin Zone
      { key: 'basin', label: 'Basin', zone: 'basin_zone', order: 1, auto: false, optional: false },
      { key: 'mixer', label: 'Basin Mixer', zone: 'basin_zone', order: 2, auto: false, optional: false },
      { key: 'concealed_body', label: 'Concealed Body', zone: 'basin_zone', order: 3, auto: true, optional: false },
      
      // WC Zone
      { key: 'wc', label: 'WC', zone: 'wc_zone', order: 1, auto: false, optional: false },
      { key: 'health_faucet', label: 'Health Faucet', zone: 'wc_zone', order: 2, auto: false, optional: true },
      
      // Shower Zone
      { key: 'hand_shower', label: 'Hand Shower', zone: 'shower_zone', order: 1, auto: false, optional: false },
      { key: 'hand_shower_hose', label: 'Hand Shower Hose', zone: 'shower_zone', order: 2, auto: true, optional: false },
      { key: 'hand_shower_outlet', label: 'Hand Shower Wall Outlet', zone: 'shower_zone', order: 3, auto: true, optional: false },
      { key: 'hand_shower_rail', label: 'Hand Shower Rail', zone: 'shower_zone', order: 4, auto: false, optional: true },
      { key: 'overhead_shower', label: 'Overhead Shower', zone: 'shower_zone', order: 5, auto: false, optional: false },
      { key: 'shower_arm', label: 'Shower Arm', zone: 'shower_zone', order: 6, auto: true, optional: false },
      { key: 'diverter', label: 'Diverter', zone: 'shower_zone', order: 7, auto: false, optional: false },
      { key: 'diverter_concealed_body', label: 'Diverter Concealed Body', zone: 'shower_zone', order: 8, auto: true, optional: false },
      { key: 'shower_panel', label: 'Shower Panel', zone: 'shower_zone', order: 9, auto: false, optional: false },
      { key: 'geyser', label: 'Geyser', zone: 'shower_zone', order: 10, auto: false, optional: true },
      
      // Accessories Zone
      { key: 'health_faucet_set', label: 'Health Faucet Set', zone: 'accessories_zone', order: 1, auto: false, optional: true },
      { key: 'shower_drain', label: 'Shower Drain', zone: 'accessories_zone', order: 2, auto: false, optional: true },
      { key: 'floor_drain_wc', label: 'Floor Drain near WC', zone: 'accessories_zone', order: 3, auto: false, optional: true },
      { key: 'toilet_paper_holder', label: 'Toilet Paper Holder', zone: 'accessories_zone', order: 4, auto: false, optional: true },
      { key: 'hand_towel_rail', label: 'Hand Towel Rail', zone: 'accessories_zone', order: 5, auto: false, optional: true },
      { key: 'towel_rack', label: 'Towel Rack', zone: 'accessories_zone', order: 6, auto: false, optional: true },
      { key: 'robe_hook', label: 'Robe Hook', zone: 'accessories_zone', order: 7, auto: false, optional: true },
      { key: 'drain', label: 'Drain', zone: 'accessories_zone', order: 8, auto: false, optional: true },
      
      // Tiles Zone
      { key: 'wall_tiles', label: 'Wall Tiles', zone: 'tiles_zone', order: 1, auto: false, optional: false },
      { key: 'feature_wall_tiles', label: 'Feature Wall Tiles', zone: 'tiles_zone', order: 2, auto: false, optional: true },
      { key: 'floor_tiles', label: 'Floor Tiles', zone: 'tiles_zone', order: 3, auto: false, optional: false }
    ];
    
    // Merge with custom categories
    return [...defaults, ...customCategories];
  };

  const cats = React.useMemo(() => {
    const allCats = getDefaultCategories();
    return allCats.map(c => c.key);
  }, [customCategories]);

  const debug = (msg) => {
    const timestamp = new Date().toLocaleTimeString();
    setLog(p => [...p.slice(-100), `${timestamp}: ${msg}`]); // Keep last 100 entries
  };

  // Real localStorage implementation
  const saveToStorage = (key, data) => {
    try {
      if (typeof window === 'undefined' || !window.localStorage) {
        setStorageAvailable(false);
        return false;
      }
      debug(`Saving to storage: ${key}`);
      const serialized = JSON.stringify(data);
      localStorage.setItem(`bathroom_config_${key}`, serialized);
      debug(`Saved ${(serialized.length / 1024).toFixed(2)} KB`);
      return true;
    } catch (e) {
      debug(`‚ö†Ô∏è Storage error: ${e.message}`);
      setStorageAvailable(false);
      return false;
    }
  };

  const loadFromStorage = (key) => {
    try {
      if (typeof window === 'undefined' || !window.localStorage) {
        return null;
      }
      const item = localStorage.getItem(`bathroom_config_${key}`);
      return item ? JSON.parse(item) : null;
    } catch (e) {
      debug(`‚ö†Ô∏è Load error: ${e.message}`);
      return null;
    }
  };

  const clearStorage = () => {
    try {
      const keys = ['bathroomItems', 'bathrooms', 'currency', 'currencyCode', 'customCategories', 'finalSelections', 'hasVisited'];
      keys.forEach(key => localStorage.removeItem(`bathroom_config_${key}`));
      debug('All storage cleared');
      return true;
    } catch (e) {
      debug(`‚ö†Ô∏è Clear error: ${e.message}`);
      return false;
    }
  };






  React.useEffect(() => {
    debug('App initialized');
    
    // Check if first visit
    const hasVisited = loadFromStorage('hasVisited');
    if (!hasVisited) {
      setShowIntro(true);
      saveToStorage('hasVisited', true);
    }
    
    const storedItems = loadFromStorage('bathroomItems');
    const storedBathrooms = loadFromStorage('bathrooms');
    const storedCurrency = loadFromStorage('currency');
    const storedCurrencyCode = loadFromStorage('currencyCode');
    const storedCustomCategories = loadFromStorage('customCategories');
    const storedFinalSelections = loadFromStorage('finalSelections');
    
    if (storedItems) {
      setItems(storedItems);
      debug(`Loaded ${storedItems.length} items from storage`);
    }
    if (storedBathrooms) {
      setBathrooms(storedBathrooms);
      debug(`Loaded ${storedBathrooms.length} bathrooms from storage`);
    }
    if (storedCurrency) {
      setCurrency(storedCurrency);
      setCurrencyCode(storedCurrencyCode || 'INR');
    } else {
      // First time user - show currency setup
      setShowCurrencySetup(true);
    }
    if (storedCustomCategories) {
      setCustomCategories(storedCustomCategories);
      debug(`Loaded ${storedCustomCategories.length} custom categories`);
    }
    if (storedFinalSelections) {
      setFinalSelections(storedFinalSelections);
      debug(`Loaded final selections`);
    }
  }, []);

  React.useEffect(() => {
    if (items.length > 0) {
      saveToStorage('bathroomItems', items);
    }
  }, [items]);

  React.useEffect(() => {
    if (bathrooms.length > 0) {
      saveToStorage('bathrooms', bathrooms);
    }
  }, [bathrooms]);

  React.useEffect(() => {
    saveToStorage('currency', currency);
    saveToStorage('currencyCode', currencyCode);
  }, [currency, currencyCode]);

  React.useEffect(() => {
    if (customCategories.length > 0) {
      saveToStorage('customCategories', customCategories);
    }
  }, [customCategories]);

  React.useEffect(() => {
    if (Object.keys(finalSelections).length > 0) {
      saveToStorage('finalSelections', finalSelections);
    }
  }, [finalSelections]);

  const addItem = () => {
    if (!brand || !model) {
      alert('Brand and Model are required!');
      return;
    }

    const newItem = {
      id: Date.now(),
      brand,
      model,
      category,
      series,
      description,
      type,
      price: parseFloat(price) || 0,
      imageUrl: uploadedImage || imageUrl,
      relatedItems: relatedItems.split(',').map(s => s.trim()).filter(Boolean)
    };

    if (editingId) {
      setItems(items.map(it => it.id === editingId ? { ...newItem, id: editingId } : it));
      setEditingId(null);
      debug(`Updated item: ${brand} ${model}`);
      setNotification({ type: 'success', message: 'Item updated successfully!' });
    } else {
      setItems([...items, newItem]);
      debug(`Added item: ${brand} ${model}`);
      setNotification({ type: 'success', message: 'Item added successfully!' });
    }

    // Clear form
    setBrand('');
    setModel('');
    setSeries('');
    setDescription('');
    setType('');
    setPrice('');
    setImageUrl('');
    setUploadedImage(null);
    setRelatedItems('');
    setTimeout(() => setNotification(null), 3000);
  };

  const deleteItem = (id) => {
    setItems(items.filter(it => it.id !== id));
    setDeleteConfirm(null);
    debug(`Deleted item ID: ${id}`);
    setNotification({ type: 'success', message: 'Item deleted successfully!' });
    setTimeout(() => setNotification(null), 3000);
  };

  const editItem = (item) => {
    setBrand(item.brand);
    setModel(item.model);
    setCategory(item.category);
    setSeries(item.series || '');
    setDescription(item.description || '');
    setType(item.type || '');
    setPrice(item.price?.toString() || '');
    setImageUrl(item.imageUrl || '');
    setRelatedItems((item.relatedItems || []).join(', '));
    setEditingId(item.id);
    window.scrollTo({ top: 0, behavior: 'smooth' });
  };

  const handleImageUpload = (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onloadend = () => {
        setUploadedImage(reader.result);
        debug('Image uploaded');
      };
      reader.readAsDataURL(file);
    }
  };

  const addBathroom = () => {
    const name = prompt('Enter bathroom name:');
    if (name) {
      const newBathroom = {
        id: Date.now(),
        name,
        importance: 'medium',
        numOptions: 2,
        options: [{
          id: Date.now(),
          name: 'Option A',
          selections: {},
          includedOptionalItems: []
        }, {
          id: Date.now() + 1,
          name: 'Option B',
          selections: {},
          includedOptionalItems: []
        }],
        renders: []
      };
      setBathrooms([...bathrooms, newBathroom]);
      debug(`Added bathroom: ${name}`);
      setNotification({ type: 'success', message: `Bathroom "${name}" created!` });
      setTimeout(() => setNotification(null), 3000);
    }
  };

  const deleteBathroom = (id) => {
    if (confirm('Delete this bathroom? This cannot be undone.')) {
      setBathrooms(bathrooms.filter(b => b.id !== id));
      if (selectedBathroom?.id === id) {
        setSelectedBathroom(null);
      }
      debug(`Deleted bathroom ID: ${id}`);
      setNotification({ type: 'success', message: 'Bathroom deleted!' });
      setTimeout(() => setNotification(null), 3000);
    }
  };

  const updateBathroomOptions = (bathroomId, numOptions) => {
    const num = Math.min(5, Math.max(1, parseInt(numOptions) || 2));
    setBathrooms(bathrooms.map(b => {
      if (b.id === bathroomId) {
        const currentOptions = b.options || [];
        const newOptions = [];
        
        for (let i = 0; i < num; i++) {
          if (currentOptions[i]) {
            newOptions.push(currentOptions[i]);
          } else {
            newOptions.push({
              id: Date.now() + i,
              name: `Option ${String.fromCharCode(65 + i)}`,
              selections: {},
              includedOptionalItems: []
            });
          }
        }
        
        return { ...b, numOptions: num, options: newOptions };
      }
      return b;
    }));
  };

  const updateBathroomImportance = (bathroomId, importance) => {
    setBathrooms(bathrooms.map(b => 
      b.id === bathroomId ? { ...b, importance } : b
    ));
  };

  const selectBathroom = (bathroom) => {
    setSelectedBathroom(bathroom);
    setView('configure');
  };

  const handleSelection = (optionId, category, itemId) => {
    if (!selectedBathroom) return;

    const updatedBathrooms = bathrooms.map(b => {
      if (b.id === selectedBathroom.id) {
        const updatedOptions = b.options.map(opt => {
          if (opt.id === optionId) {
            const newSelections = { ...opt.selections, [category]: itemId };
            
            // Auto-select related items
            const selectedItem = items.find(it => it.id === itemId);
            if (selectedItem?.relatedItems?.length > 0) {
              selectedItem.relatedItems.forEach(relatedItemId => {
                const relatedItem = items.find(it => it.id.toString() === relatedItemId.toString());
                if (relatedItem) {
                  const catDef = getDefaultCategories().find(c => c.key === relatedItem.category);
                  if (catDef?.auto) {
                    newSelections[relatedItem.category] = relatedItem.id;
                  }
                }
              });
            }
            
            return { ...opt, selections: newSelections };
          }
          return opt;
        });
        return { ...b, options: updatedOptions };
      }
      return b;
    });

    setBathrooms(updatedBathrooms);
    setSelectedBathroom(updatedBathrooms.find(b => b.id === selectedBathroom.id));
  };

  const toggleOptionalItem = (optionId, categoryKey) => {
    if (!selectedBathroom) return;

    const updatedBathrooms = bathrooms.map(b => {
      if (b.id === selectedBathroom.id) {
        const updatedOptions = b.options.map(opt => {
          if (opt.id === optionId) {
            const included = opt.includedOptionalItems || [];
            const newIncluded = included.includes(categoryKey)
              ? included.filter(k => k !== categoryKey)
              : [...included, categoryKey];
            return { ...opt, includedOptionalItems: newIncluded };
          }
          return opt;
        });
        return { ...b, options: updatedOptions };
      }
      return b;
    });

    setBathrooms(updatedBathrooms);
    setSelectedBathroom(updatedBathrooms.find(b => b.id === selectedBathroom.id));
  };

  const getCategoryName = (key) => {
    const catDef = getDefaultCategories().find(c => c.key === key);
    return catDef ? catDef.label : key;
  };

  const getZoneName = (zoneKey) => {
    const zoneNames = {
      'basin_zone': 'Basin Zone',
      'wc_zone': 'WC Zone',
      'shower_zone': 'Shower Zone',
      'accessories_zone': 'Accessories',
      'tiles_zone': 'Tiles'
    };
    return zoneNames[zoneKey] || zoneKey;
  };

  const calculateOptionTotal = (option) => {
    let total = 0;
    const allCategories = getDefaultCategories();
    
    allCategories.forEach(catDef => {
      const isIncluded = !catDef.optional || (option.includedOptionalItems || []).includes(catDef.key);
      if (isIncluded) {
        const itemId = option.selections[catDef.key];
        if (itemId) {
          const item = items.find(it => it.id === itemId);
          if (item) {
            total += item.price || 0;
          }
        }
      }
    });
    
    return total;
  };

  const exportProcurementToExcel = () => {
    debug('Generating Excel export...');
    
    // Calculate procurement data
    const brandMap = {};
    
    bathrooms.forEach(bathroom => {
      bathroom.options.forEach(option => {
        const allCategories = getDefaultCategories();
        
        allCategories.forEach(catDef => {
          const isIncluded = !catDef.optional || (option.includedOptionalItems || []).includes(catDef.key);
          if (isIncluded) {
            const itemId = option.selections[catDef.key];
            if (itemId) {
              const item = items.find(it => it.id === itemId);
              if (item) {
                const key = `${item.brand}|||${item.model}`;
                if (!brandMap[key]) {
                  brandMap[key] = {
                    brand: item.brand,
                    model: item.model,
                    category: getCategoryName(item.category),
                    price: item.price || 0,
                    quantity: 0
                  };
                }
                brandMap[key].quantity += 1;
              }
            }
          }
        });
      });
    });

    const procurementData = Object.values(brandMap).sort((a, b) => {
      if (a.brand !== b.brand) return a.brand.localeCompare(b.brand);
      return a.model.localeCompare(b.model);
    });

    // Create CSV content
    let csv = 'Brand,Model,Category,Quantity,Unit Price,Total Price\n';
    
    let grandTotal = 0;
    procurementData.forEach(item => {
      const totalPrice = item.quantity * item.price;
      grandTotal += totalPrice;
      csv += `"${item.brand}","${item.model}","${item.category}",${item.quantity},${item.price.toFixed(2)},${totalPrice.toFixed(2)}\n`;
    });
    
    csv += `\n,,,Total,,${grandTotal.toFixed(2)}\n`;

    // Download CSV
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    const url = URL.createObjectURL(blob);
    link.setAttribute('href', url);
    link.setAttribute('download', 'procurement.csv');
    link.style.visibility = 'hidden';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    
    debug('‚úì Excel export complete');
    setNotification({ type: 'success', message: 'Excel file downloaded!' });
    setTimeout(() => setNotification(null), 3000);
  };

  const exportBackup = () => {
    const backup = {
      version: '2.0',
      items,
      bathrooms,
      currency,
      currencyCode,
      customCategories,
      finalSelections,
      timestamp: new Date().toISOString()
    };
    
    const dataStr = JSON.stringify(backup, null, 2);
    const blob = new Blob([dataStr], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `bathroom-configurator-backup-${Date.now()}.json`;
    link.click();
    URL.revokeObjectURL(url);
    
    debug('Backup exported');
    setNotification({ type: 'success', message: 'Backup downloaded!' });
    setTimeout(() => setNotification(null), 3000);
  };

  const importBackup = (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (event) => {
        try {
          const backup = JSON.parse(event.target.result);
          
          // Map old format to new format for compatibility
          const mappedItems = (backup.items || []).map(item => ({
            id: item.item_id || item.id || Date.now() + Math.random(),
            brand: item.brand,
            model: item.model,
            category: item.category,
            series: item.series || '',
            description: item.description || '',
            type: item.type || '',
            price: parseFloat(item.unit_price || item.price || 0),
            imageUrl: item.image_data || item.image_url || item.imageUrl || '',
            relatedItems: item.related_items || item.relatedItems || []
          }));
          
          setItems(mappedItems);
          setBathrooms(backup.bathrooms || []);
          setCurrency(backup.currency || '‚Çπ');
          setCurrencyCode(backup.currencyCode || 'INR');
          setCustomCategories(backup.customCategories || []);
          setFinalSelections(backup.finalSelections || {});
          
          debug(`Backup imported successfully - ${mappedItems.length} items loaded`);
          setNotification({ type: 'success', message: `Backup restored! Loaded ${mappedItems.length} items.` });
          setTimeout(() => setNotification(null), 3000);
        } catch (error) {
          debug(`Import error: ${error.message}`);
          setNotification({ type: 'error', message: 'Failed to import backup!' });
          setTimeout(() => setNotification(null), 3000);
        }
      };
      reader.readAsText(file);
    }
  };

  const duplicateOption = (bathroomId, optionId) => {
    setBathrooms(bathrooms.map(b => {
      if (b.id === bathroomId) {
        const optionToDuplicate = b.options.find(opt => opt.id === optionId);
        if (optionToDuplicate) {
          const newOption = {
            ...optionToDuplicate,
            id: Date.now(),
            name: `${optionToDuplicate.name} (Copy)`
          };
          return {
            ...b,
            options: [...b.options, newOption],
            numOptions: b.numOptions + 1
          };
        }
      }
      return b;
    }));
    
    setNotification({ type: 'success', message: 'Option duplicated!' });
    setTimeout(() => setNotification(null), 3000);
  };

  const deleteOption = (bathroomId, optionId) => {
    setBathrooms(bathrooms.map(b => {
      if (b.id === bathroomId && b.options.length > 1) {
        const filteredOptions = b.options.filter(opt => opt.id !== optionId);
        // Renumber options sequentially
        const renumberedOptions = filteredOptions.map((opt, idx) => ({
          ...opt,
          name: opt.name.includes('Copy') ? `Option ${String.fromCharCode(65 + idx)} (Copy)` : `Option ${String.fromCharCode(65 + idx)}`
        }));
        return {
          ...b,
          options: renumberedOptions,
          numOptions: b.numOptions - 1
        };
      }
      return b;
    }));
    
    setDeleteConfirmOption(null);
    setNotification({ type: 'success', message: 'Option deleted!' });
    setTimeout(() => setNotification(null), 3000);
  };

  const bulkEdit = (field, value) => {
    setItems(items.map(item => 
      selectedItems.includes(item.id) ? { ...item, [field]: value } : item
    ));
    setNotification({ type: 'success', message: `Updated ${selectedItems.length} items!` });
    setTimeout(() => setNotification(null), 3000);
  };

  const toggleItemSelection = (id) => {
    setSelectedItems(prev => 
      prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]
    );
  };

  const selectAllItems = () => {
    const filteredItems = filterCat === 'all' ? items : items.filter(it => it.category === filterCat);
    setSelectedItems(filteredItems.map(it => it.id));
  };

  const deselectAllItems = () => {
    setSelectedItems([]);
  };

  const handleRenderUpload = (bathroomId, e) => {
    const files = Array.from(e.target.files);
    const readers = files.map(file => {
      return new Promise((resolve) => {
        const reader = new FileReader();
        reader.onloadend = () => resolve(reader.result);
        reader.readAsDataURL(file);
      });
    });

    Promise.all(readers).then(results => {
      setBathrooms(bathrooms.map(b => {
        if (b.id === bathroomId) {
          return {
            ...b,
            renders: [...(b.renders || []), ...results]
          };
        }
        return b;
      }));
      debug(`Uploaded ${files.length} render(s)`);
    });
  };

  const deleteRender = (bathroomId, renderIndex) => {
    setBathrooms(bathrooms.map(b => {
      if (b.id === bathroomId) {
        return {
          ...b,
          renders: b.renders.filter((_, idx) => idx !== renderIndex)
        };
      }
      return b;
    }));
  };

  const currencyOptions = [
    { code: 'INR', symbol: '‚Çπ', name: 'Indian Rupee' },
    { code: 'USD', symbol: '$', name: 'US Dollar' },
    { code: 'EUR', symbol: '‚Ç¨', name: 'Euro' },
    { code: 'GBP', symbol: '¬£', name: 'British Pound' },
    { code: 'AUD', symbol: 'A$', name: 'Australian Dollar' },
    { code: 'CAD', symbol: 'C$', name: 'Canadian Dollar' },
    { code: 'SGD', symbol: 'S$', name: 'Singapore Dollar' },
    { code: 'AED', symbol: 'AED', name: 'UAE Dirham' }
  ];

  const setCurrencyFromCode = (code) => {
    const curr = currencyOptions.find(c => c.code === code);
    if (curr) {
      setCurrency(curr.symbol);
      setCurrencyCode(code);
    }
  };

  // Group categories by zone
  const categoriesByZone = React.useMemo(() => {
    const allCategories = getDefaultCategories();
    const zones = {};
    
    allCategories.forEach(cat => {
      if (!zones[cat.zone]) {
        zones[cat.zone] = [];
      }
      zones[cat.zone].push(cat);
    });
    
    // Sort categories within each zone by order
    Object.keys(zones).forEach(zoneKey => {
      zones[zoneKey].sort((a, b) => a.order - b.order);
    });
    
    return zones;
  }, []);

  const filteredItems = filterCat === 'all' ? items : items.filter(it => it.category === filterCat);

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6">
      {/* Notification */}
      {notification && (
        <div className={`fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg ${
          notification.type === 'success' ? 'bg-green-500' : 'bg-red-500'
        } text-white font-semibold`}>
          {notification.message}
        </div>
      )}

      {/* Currency Setup Modal */}
      {showCurrencySetup && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white rounded-lg p-8 max-w-md w-full mx-4">
            <h2 className="text-2xl font-bold mb-4 text-gray-800">Welcome! üéâ</h2>
            <p className="text-gray-600 mb-6">Select your currency to get started:</p>
            <div className="space-y-2 mb-6">
              {currencyOptions.map(curr => (
                <button
                  key={curr.code}
                  onClick={() => {
                    setCurrencyFromCode(curr.code);
                    setShowCurrencySetup(false);
                    setNotification({ type: 'success', message: `Currency set to ${curr.name}` });
                    setTimeout(() => setNotification(null), 3000);
                  }}
                  className="w-full text-left px-4 py-3 rounded-lg border-2 border-gray-200 hover:border-blue-500 hover:bg-blue-50 transition"
                >
                  <span className="font-semibold">{curr.symbol} {curr.code}</span>
                  <span className="text-gray-600 ml-2">- {curr.name}</span>
                </button>
              ))}
            </div>
            <p className="text-xs text-gray-500 italic">
              Note: Currency is cosmetic only. Enter all prices in your chosen currency.
            </p>
          </div>
        </div>
      )}

      {/* Introduction Screen */}
      {showIntro && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-2 sm:p-4">
          <div className="bg-white rounded-lg p-4 sm:p-6 md:p-8 max-w-4xl w-full max-h-[95vh] overflow-y-auto">
            <div className="text-center mb-4 sm:mb-6">
              <div className="text-4xl sm:text-6xl mb-3 sm:mb-4">üöø</div>
              <h1 className="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-800 mb-2">
                Welcome to Bathroom Configurator
              </h1>
              <p className="text-lg sm:text-xl text-gray-600">
                Plan. Compare. Procure.
              </p>
            </div>

            <div className="grid sm:grid-cols-2 gap-3 sm:gap-4 md:gap-6 mb-4 sm:mb-6">
              <div className="bg-blue-50 rounded-lg p-4 sm:p-6">
                <h3 className="text-base sm:text-lg font-bold mb-2 sm:mb-3">üè† Born from Experience</h3>
                <p className="text-gray-700 text-sm">
                  What started as a desperate attempt to organize bathroom fittings for a real DIY renovation 
                  turned into this tool. If you're drowning in product catalogs, this is for you!
                </p>
              </div>

              <div className="bg-green-50 rounded-lg p-4 sm:p-6">
                <h3 className="text-base sm:text-lg font-bold mb-2 sm:mb-3">‚ú® Key Features</h3>
                <ul className="text-sm text-gray-700 space-y-1">
                  <li>‚Ä¢ Compare multiple design options</li>
                  <li>‚Ä¢ Track costs across products</li>
                  <li>‚Ä¢ Generate procurement lists</li>
                  <li>‚Ä¢ Export PDF & Excel reports</li>
                  <li>‚Ä¢ Auto-save your work</li>
                </ul>
              </div>

              <div className="bg-purple-50 rounded-lg p-4 sm:p-6">
                <h3 className="text-base sm:text-lg font-bold mb-2 sm:mb-3">üë• Perfect For</h3>
                <ul className="text-sm text-gray-700 space-y-1">
                  <li>‚Ä¢ Homeowners planning renovations</li>
                  <li>‚Ä¢ Contractors managing projects</li>
                  <li>‚Ä¢ Interior designers</li>
                  <li>‚Ä¢ Anyone comparing bathroom options</li>
                </ul>
              </div>

              <div className="bg-orange-50 rounded-lg p-4 sm:p-6">
                <h3 className="text-base sm:text-lg font-bold mb-2 sm:mb-3">üöÄ Quick Start</h3>
                <ol className="text-sm text-gray-700 space-y-1">
                  <li>1. Set your currency</li>
                  <li>2. Add products to database</li>
                  <li>3. Create bathrooms</li>
                  <li>4. Configure options</li>
                  <li>5. Compare & export</li>
                </ol>
              </div>
            </div>

            <div className="text-center">
              <button
                onClick={() => setShowIntro(false)}
                className="bg-gradient-to-r from-blue-500 to-indigo-500 text-white px-6 sm:px-8 py-2 sm:py-3 rounded-lg text-sm sm:text-base font-semibold hover:from-blue-600 hover:to-indigo-600 transition shadow-lg"
              >
                Get Started ‚Üí
              </button>
              <p className="text-xs text-gray-500 mt-3 sm:mt-4">
                üí° Tip: Click the Help button anytime for detailed guidance
              </p>
            </div>
          </div>
        </div>
      )}

      <div className="max-w-7xl mx-auto">
        {/* Header */}
        <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
          <div className="flex items-center justify-between flex-wrap gap-4">
            <div>
              <h1 className="text-3xl font-bold text-gray-800 mb-1">üöø Bathroom Configurator</h1>
              <p className="text-gray-600 text-sm">Compare options, manage procurement, export reports</p>
            </div>
            <div className="flex items-center gap-3">
              <div className="flex items-center gap-2">
                <label className="text-sm text-gray-600">Currency:</label>
                <select
                  value={currencyCode}
                  onChange={(e) => setCurrencyFromCode(e.target.value)}
                  className="border rounded px-2 py-1 text-sm font-semibold bg-white"
                >
                  {currencyOptions.map(curr => (
                    <option key={curr.code} value={curr.code}>
                      {curr.symbol} {curr.code}
                    </option>
                  ))}
                </select>
              </div>
              <button
                onClick={() => setView('help')}
                className="bg-gradient-to-r from-green-500 to-teal-500 text-white px-4 py-2 rounded-lg font-semibold hover:from-green-600 hover:to-teal-600 transition shadow"
              >
                üìñ Help
              </button>
            </div>
          </div>
        </div>

        {/* Navigation */}
        <div className="bg-white rounded-lg shadow-lg p-4 mb-6">
          <div className="flex flex-wrap gap-2">
            {['database', 'bathrooms', 'configure', 'final', 'overview', 'summary', 'procurement', 'settings'].map(v => (
              <button
                key={v}
                onClick={() => {
                  setView(v);
                  if (typeof window !== 'undefined' && window.sc_log_pv) {
                    try { window.sc_log_pv(); } catch(e) {}
                  }
                }}
                className={`px-4 py-2 rounded-lg font-semibold transition ${
                  view === v
                    ? 'bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg'
                    : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                }`}
              >
                {v === 'database' && 'üìä Database'}
                {v === 'bathrooms' && 'üöø Bathrooms'}
                {v === 'configure' && '‚öôÔ∏è Configure'}
                {v === 'final' && '‚úÖ Final Selections'}
                {v === 'summary' && 'üìã Summary'}
                {v === 'overview' && 'üîç Overview'}
                {v === 'procurement' && 'üì¶ Procurement'}
                {v === 'settings' && '‚öôÔ∏è Settings'}
              </button>
            ))}
          </div>
        </div>

        {/* Storage Warning */}
        {!storageAvailable && (
          <div className="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-6 rounded">
            <div className="flex items-start">
              <AlertCircle className="w-5 h-5 mr-2 mt-0.5" />
              <div>
                <p className="font-bold">Storage Unavailable</p>
                <p className="text-sm">Your data cannot be auto-saved. Please use the Export Backup button to save your work.</p>
              </div>
            </div>
          </div>
        )}

        {/* DATABASE VIEW */}
        {view === 'database' && (
          <div className="space-y-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
              <div className="flex justify-between items-center mb-4">
                <h2 className="text-2xl font-bold text-gray-800">Product Database</h2>
                <div className="flex gap-2">
                  <button
                    onClick={() => setBulkEditMode(!bulkEditMode)}
                    className={`px-4 py-2 rounded-lg font-semibold transition ${
                      bulkEditMode ? 'bg-orange-500 text-white' : 'bg-gray-200 text-gray-700'
                    }`}
                  >
                    {bulkEditMode ? '‚úì Bulk Edit Mode' : 'Bulk Edit'}
                  </button>
                  <button
                    onClick={exportBackup}
                    className="bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-600 transition flex items-center gap-2"
                  >
                    <Download className="w-4 h-4" /> Export Backup
                  </button>
                  <label className="bg-green-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-green-600 transition cursor-pointer flex items-center gap-2">
                    <Upload className="w-4 h-4" /> Import Backup
                    <input type="file" accept=".json" onChange={importBackup} className="hidden" />
                  </label>
                </div>
              </div>

              {/* Bulk Edit Panel */}
              {bulkEditMode && selectedItems.length > 0 && (
                <div className="bg-orange-50 border-2 border-orange-300 rounded-lg p-4 mb-4">
                  <div className="flex justify-between items-center mb-3">
                    <h3 className="font-bold text-gray-800">Bulk Edit ({selectedItems.length} items selected)</h3>
                    <button
                      onClick={() => {
                        setBulkEditMode(false);
                        setSelectedItems([]);
                      }}
                      className="text-gray-600 hover:text-gray-800"
                    >
                      ‚úï Close
                    </button>
                  </div>
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <div>
                      <label className="block text-sm font-semibold mb-1">Change Category:</label>
                      <select
                        onChange={(e) => bulkEdit('category', e.target.value)}
                        className="w-full border rounded px-3 py-2"
                      >
                        <option value="">-- Select Category --</option>
                        {cats.map(c => (
                          <option key={c} value={c}>{getCategoryName(c)}</option>
                        ))}
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-semibold mb-1">Change Brand:</label>
                      <input
                        type="text"
                        placeholder="New brand name"
                        onChange={(e) => {
                          if (e.target.value) bulkEdit('brand', e.target.value);
                        }}
                        className="w-full border rounded px-3 py-2"
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-semibold mb-1">Apply Discount (%):</label>
                      <input
                        type="number"
                        placeholder="e.g., 10"
                        onChange={(e) => {
                          const discount = parseFloat(e.target.value);
                          if (!isNaN(discount)) {
                            setItems(items.map(item =>
                              selectedItems.includes(item.id)
                                ? { ...item, price: item.price * (1 - discount / 100) }
                                : item
                            ));
                          }
                        }}
                        className="w-full border rounded px-3 py-2"
                      />
                    </div>
                  </div>
                </div>
              )}

              {/* Add/Edit Form */}
              <div className="bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg mb-6 border-2 border-blue-200">
                <h3 className="text-lg font-bold mb-4 text-gray-800">
                  {editingId ? '‚úèÔ∏è Edit Product' : '‚ûï Add New Product'}
                </h3>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                  <div>
                    <label className="block text-sm font-semibold mb-1">Brand *</label>
                    <input
                      type="text"
                      value={brand}
                      onChange={(e) => setBrand(e.target.value)}
                      className="w-full border rounded px-3 py-2"
                      placeholder="e.g., Kohler"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold mb-1">Model *</label>
                    <input
                      type="text"
                      value={model}
                      onChange={(e) => setModel(e.target.value)}
                      className="w-full border rounded px-3 py-2"
                      placeholder="e.g., Parallel"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold mb-1">Category *</label>
                    <select
                      value={category}
                      onChange={(e) => setCategory(e.target.value)}
                      className="w-full border rounded px-3 py-2"
                    >
                      {cats.map(c => (
                        <option key={c} value={c}>{getCategoryName(c)}</option>
                      ))}
                    </select>
                  </div>
                  <div>
                    <label className="block text-sm font-semibold mb-1">Series</label>
                    <input
                      type="text"
                      value={series}
                      onChange={(e) => setSeries(e.target.value)}
                      className="w-full border rounded px-3 py-2"
                      placeholder="Optional"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold mb-1">Type</label>
                    <input
                      type="text"
                      value={type}
                      onChange={(e) => setType(e.target.value)}
                      className="w-full border rounded px-3 py-2"
                      placeholder="Optional"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold mb-1">Price ({currency})</label>
                    <input
                      type="number"
                      value={price}
                      onChange={(e) => setPrice(e.target.value)}
                      className="w-full border rounded px-3 py-2"
                      placeholder="0.00"
                      step="0.01"
                    />
                  </div>
                  <div className="md:col-span-2">
                    <label className="block text-sm font-semibold mb-1">Description</label>
                    <input
                      type="text"
                      value={description}
                      onChange={(e) => setDescription(e.target.value)}
                      className="w-full border rounded px-3 py-2"
                      placeholder="Optional description"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold mb-1">Related Items (IDs)</label>
                    <input
                      type="text"
                      value={relatedItems}
                      onChange={(e) => setRelatedItems(e.target.value)}
                      className="w-full border rounded px-3 py-2"
                      placeholder="e.g., 123, 456"
                    />
                    <p className="text-xs text-gray-500 mt-1">Comma-separated item IDs for auto-selection</p>
                  </div>
                  <div className="md:col-span-2">
                    <label className="block text-sm font-semibold mb-1">Image URL</label>
                    <input
                      type="text"
                      value={imageUrl}
                      onChange={(e) => setImageUrl(e.target.value)}
                      className="w-full border rounded px-3 py-2"
                      placeholder="https://example.com/image.jpg"
                    />
                  </div>
                  <div>
                    <label className="block text-sm font-semibold mb-1">Or Upload Image</label>
                    <input
                      type="file"
                      accept="image/*"
                      onChange={handleImageUpload}
                      className="w-full border rounded px-3 py-2 bg-white"
                    />
                  </div>
                </div>
                <div className="mt-4 flex gap-2">
                  <button
                    onClick={addItem}
                    className="bg-gradient-to-r from-green-500 to-emerald-500 text-white px-6 py-2 rounded-lg font-semibold hover:from-green-600 hover:to-emerald-600 transition shadow"
                  >
                    {editingId ? 'üíæ Update Product' : '‚ûï Add Product'}
                  </button>
                  {editingId && (
                    <button
                      onClick={() => {
                        setEditingId(null);
                        setBrand('');
                        setModel('');
                        setSeries('');
                        setDescription('');
                        setType('');
                        setPrice('');
                        setImageUrl('');
                        setUploadedImage(null);
                        setRelatedItems('');
                      }}
                      className="bg-gray-300 text-gray-700 px-6 py-2 rounded-lg font-semibold hover:bg-gray-400 transition"
                    >
                      Cancel
                    </button>
                  )}
                </div>
              </div>

              {/* Filter and Actions */}
              <div className="flex justify-between items-center mb-4">
                <div className="flex items-center gap-3">
                  <label className="font-semibold text-gray-700">Filter:</label>
                  <select
                    value={filterCat}
                    onChange={(e) => setFilterCat(e.target.value)}
                    className="border rounded px-3 py-2"
                  >
                    <option value="all">All Categories</option>
                    {cats.map(c => (
                      <option key={c} value={c}>{getCategoryName(c)}</option>
                    ))}
                  </select>
                </div>
                {bulkEditMode && (
                  <div className="flex gap-2">
                    <button
                      onClick={selectAllItems}
                      className="text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded hover:bg-blue-200"
                    >
                      Select All
                    </button>
                    <button
                      onClick={deselectAllItems}
                      className="text-sm bg-gray-100 text-gray-700 px-3 py-1 rounded hover:bg-gray-200"
                    >
                      Deselect All
                    </button>
                  </div>
                )}
              </div>

              {/* Items Table */}
              {filteredItems.length === 0 ? (
                <div className="text-center py-12 text-gray-500">
                  <p className="text-lg">No products yet. Add your first product above! üëÜ</p>
                </div>
              ) : (
                <div className="overflow-x-auto">
                  <table className="w-full border-collapse">
                    <thead>
                      <tr className="bg-gray-100">
                        {bulkEditMode && <th className="border p-2">Select</th>}
                        <th className="border p-2 text-left">ID</th>
                        <th className="border p-2 text-left">Image</th>
                        <th className="border p-2 text-left">Brand</th>
                        <th className="border p-2 text-left">Model</th>
                        <th className="border p-2 text-left">Category</th>
                        <th className="border p-2 text-left">Series</th>
                        <th className="border p-2 text-left">Type</th>
                        <th className="border p-2 text-left">Description</th>
                        <th className="border p-2 text-left">Price</th>
                        <th className="border p-2 text-left">Actions</th>
                      </tr>
                    </thead>
                    <tbody>
                      {filteredItems.map(item => (
                        <tr key={item.id} className={selectedItems.includes(item.id) ? 'bg-orange-50' : 'hover:bg-gray-50'}>
                          {bulkEditMode && (
                            <td className="border p-2 text-center" onClick={(e) => e.stopPropagation()}>
                              <input
                                type="checkbox"
                                checked={selectedItems.includes(item.id)}
                                onChange={() => toggleItemSelection(item.id)}
                                className="w-4 h-4"
                              />
                            </td>
                          )}
                          <td className="border p-2 text-xs text-gray-500">{item.id}</td>
                          <td className="border p-2">
                            {item.imageUrl ? (
                              <img 
                                src={item.imageUrl} 
                                alt={item.model} 
                                className="w-16 h-16 object-cover rounded" 
                                onError={(e) => {
                                  e.target.style.display = 'none';
                                  e.target.parentElement.innerHTML = '<div class="w-16 h-16 bg-gray-100 rounded flex items-center justify-center text-xs text-gray-400">No image</div>';
                                }}
                              />
                            ) : (
                              <div className="w-16 h-16 bg-gray-100 rounded flex items-center justify-center text-xs text-gray-400">No image</div>
                            )}
                          </td>
                          <td className="border p-2 font-semibold">{item.brand}</td>
                          <td className="border p-2">{item.model}</td>
                          <td className="border p-2 text-sm">{getCategoryName(item.category)}</td>
                          <td className="border p-2 text-sm text-gray-600">{item.series || '-'}</td>
                          <td className="border p-2 text-sm text-gray-600">{item.type || '-'}</td>
                          <td className="border p-2 text-sm text-gray-600">{item.description || '-'}</td>
                          <td className="border p-2 font-semibold">{currency}{item.price?.toFixed(2) || '0.00'}</td>
                          <td className="border p-2">
                            <div className="flex gap-2">
                              <button
                                onClick={() => editItem(item)}
                                className="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600"
                              >
                                Edit
                              </button>
                              <button
                                onClick={() => setDeleteConfirm(item.id)}
                                className="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600"
                              >
                                Delete
                              </button>
                            </div>
                          </td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              )}
            </div>
          </div>
        )}

        {/* BATHROOMS VIEW */}
        {view === 'bathrooms' && (
          <div className="space-y-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
              <div className="flex justify-between items-center mb-6">
                <h2 className="text-2xl font-bold text-gray-800">Your Bathrooms</h2>
                <button
                  onClick={addBathroom}
                  className="bg-gradient-to-r from-green-500 to-emerald-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-green-600 hover:to-emerald-600 transition shadow-lg"
                >
                  ‚ûï Add Bathroom
                </button>
              </div>

              {bathrooms.length === 0 ? (
                <div className="text-center py-12 text-gray-500">
                  <p className="text-lg">No bathrooms yet. Click "Add Bathroom" to get started! üëÜ</p>
                </div>
              ) : (
                <div className="grid gap-6">
                  {bathrooms.map(bathroom => (
                    <div key={bathroom.id} className="border-2 border-gray-200 rounded-lg p-6 hover:border-blue-400 transition">
                      <div className="flex justify-between items-start mb-4">
                        <div>
                          <h3 className="text-xl font-bold text-gray-800">{bathroom.name}</h3>
                          <div className="flex gap-4 mt-2">
                            <div>
                              <label className="text-sm font-semibold text-gray-600">Importance:</label>
                              <select
                                value={bathroom.importance}
                                onChange={(e) => updateBathroomImportance(bathroom.id, e.target.value)}
                                className="ml-2 border rounded px-2 py-1 text-sm"
                              >
                                <option value="high">üî¥ High</option>
                                <option value="medium">üü° Medium</option>
                                <option value="low">üü¢ Low</option>
                              </select>
                            </div>
                            <div>
                              <label className="text-sm font-semibold text-gray-600">Number of Options:</label>
                              <input
                                type="number"
                                min="1"
                                max="5"
                                value={bathroom.numOptions}
                                onChange={(e) => updateBathroomOptions(bathroom.id, e.target.value)}
                                className="ml-2 border rounded px-2 py-1 w-16 text-sm"
                              />
                            </div>
                          </div>
                        </div>
                        <div className="flex gap-2">
                          <button
                            onClick={() => selectBathroom(bathroom)}
                            className="bg-blue-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-600 transition"
                          >
                            ‚öôÔ∏è Configure
                          </button>
                          <button
                            onClick={() => deleteBathroom(bathroom.id)}
                            className="bg-red-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-red-600 transition"
                          >
                            üóëÔ∏è Delete
                          </button>
                        </div>
                      </div>

                      {/* Renders */}
                      <div className="mt-4">
                        <label className="block text-sm font-semibold mb-2">Bathroom Renders/Photos:</label>
                        <div className="flex gap-4 flex-wrap items-center">
                          {(bathroom.renders || []).map((render, idx) => (
                            <div key={idx} className="relative group">
                              <img src={render} alt={`Render ${idx + 1}`} className="w-32 h-32 object-cover rounded border-2 border-gray-300" />
                              <button
                                onClick={() => deleteRender(bathroom.id, idx)}
                                className="absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center opacity-0 group-hover:opacity-100 transition"
                              >
                                ‚úï
                              </button>
                            </div>
                          ))}
                          <label className="w-32 h-32 border-2 border-dashed border-gray-400 rounded flex items-center justify-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition">
                            <div className="text-center">
                              <Upload className="w-8 h-8 mx-auto text-gray-400 mb-1" />
                              <span className="text-xs text-gray-500">Upload</span>
                            </div>
                            <input
                              type="file"
                              accept="image/*"
                              multiple
                              onChange={(e) => handleRenderUpload(bathroom.id, e)}
                              className="hidden"
                            />
                          </label>
                        </div>
                      </div>

                      {/* Options Summary */}
                      <div className="mt-4 grid grid-cols-1 md:grid-cols-3 gap-3">
                        {bathroom.options.map(option => (
                          <div key={option.id} className="bg-gray-50 p-3 rounded border">
                            <div className="font-semibold text-sm mb-1">{option.name}</div>
                            <div className="text-xs text-gray-600">
                              {Object.keys(option.selections || {}).length} items selected
                            </div>
                            <div className="text-sm font-bold text-blue-600 mt-1">
                              {currency}{calculateOptionTotal(option).toFixed(2)}
                            </div>
                          </div>
                        ))}
                      </div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>
        )}

        {/* CONFIGURE VIEW */}
        {view === 'configure' && (
          <div className="space-y-6">
            {/* Bathroom Selector */}
            <div className="bg-white rounded-lg shadow-lg p-6">
              <div className="flex justify-between items-center">
                <div className="flex-1">
                  <label className="block text-sm font-semibold mb-2 text-gray-700">Select Bathroom:</label>
                  <select
                    value={selectedBathroom?.id || ''}
                    onChange={(e) => {
                      const bathroomId = e.target.value;
                      if (bathroomId) {
                        const bathroom = bathrooms.find(b => b.id.toString() === bathroomId);
                        if (bathroom) {
                          setSelectedBathroom(bathroom);
                          debug(`Switched to bathroom: ${bathroom.name}`);
                        }
                      } else {
                        setSelectedBathroom(null);
                      }
                    }}
                    className="border-2 border-gray-300 rounded-lg px-4 py-2 text-lg font-semibold min-w-[300px] focus:border-blue-500 focus:outline-none"
                  >
                    <option value="">-- Select a Bathroom --</option>
                    {bathrooms.map(b => (
                      <option key={b.id} value={b.id}>
                        {b.name} ({b.options.length} options)
                      </option>
                    ))}
                  </select>
                </div>
                {selectedBathroom && (
                  <button
                    onClick={() => {
                      setSelectedBathroom(null);
                      setView('bathrooms');
                    }}
                    className="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-semibold hover:bg-gray-400 transition"
                  >
                    ‚Üê Back to Bathrooms
                  </button>
                )}
              </div>
            </div>

            {!selectedBathroom ? (
              <div className="bg-white rounded-lg shadow-lg p-12 text-center">
                <p className="text-xl text-gray-600 mb-4">Please select a bathroom from the dropdown above.</p>
                <button
                  onClick={() => setView('bathrooms')}
                  className="bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-600 transition"
                >
                  Or Create a New Bathroom
                </button>
              </div>
            ) : (
              <>
                {selectedBathroom.options.map((option, optIdx) => (
                  <div key={option.id} className="bg-white rounded-lg shadow-lg p-6">
                    <div className="flex justify-between items-center mb-6 pb-4 border-b-2 border-gray-200">
                      <div>
                        <input
                          type="text"
                          value={option.name}
                          onChange={(e) => {
                            const updatedBathrooms = bathrooms.map(b => {
                              if (b.id === selectedBathroom.id) {
                                return {
                                  ...b,
                                  options: b.options.map(opt =>
                                    opt.id === option.id ? { ...opt, name: e.target.value } : opt
                                  )
                                };
                              }
                              return b;
                            });
                            setBathrooms(updatedBathrooms);
                            setSelectedBathroom(updatedBathrooms.find(b => b.id === selectedBathroom.id));
                          }}
                          className="text-xl font-bold text-gray-800 border-b-2 border-transparent hover:border-blue-300 focus:border-blue-500 focus:outline-none px-2"
                        />
                        <div className="text-sm font-bold text-blue-600 mt-2">
                          Total: {currency}{calculateOptionTotal(option).toFixed(2)}
                        </div>
                      </div>
                      <div className="flex gap-2">
                        <button
                          onClick={() => duplicateOption(selectedBathroom.id, option.id)}
                          className="bg-green-500 text-white px-3 py-2 rounded text-sm hover:bg-green-600"
                        >
                          üìã Duplicate
                        </button>
                        {selectedBathroom.options.length > 1 && (
                          <button
                            onClick={() => setDeleteConfirmOption(option.id)}
                            className="bg-red-500 text-white px-3 py-2 rounded text-sm hover:bg-red-600"
                          >
                            üóëÔ∏è Delete
                          </button>
                        )}
                      </div>
                    </div>

                    {Object.entries(categoriesByZone).map(([zoneKey, zoneCategories]) => (
                      <div key={zoneKey} className="mb-8">
                        <div className="bg-gradient-to-r from-blue-100 to-indigo-100 px-4 py-3 rounded-lg mb-4 border-l-4 border-blue-500">
                          <h4 className="font-bold text-lg text-gray-800">{getZoneName(zoneKey)}</h4>
                        </div>
                        
                        <div className="space-y-4 pl-4">
                          {zoneCategories.map(catDef => {
                            const categoryItems = items.filter(it => it.category === catDef.key);
                            const selectedItemId = option.selections[catDef.key];
                            const selectedItem = items.find(it => it.id === selectedItemId);
                            const isOptionalIncluded = (option.includedOptionalItems || []).includes(catDef.key);
                            const shouldShow = !catDef.optional || isOptionalIncluded;

                            return (
                              <div key={catDef.key} className={`border-l-2 ${shouldShow ? 'border-gray-300' : 'border-gray-200'} pl-4`}>
                                <div className="flex items-center gap-3 mb-2">
                                  {catDef.optional && (
                                    <input
                                      type="checkbox"
                                      checked={isOptionalIncluded}
                                      onChange={() => toggleOptionalItem(option.id, catDef.key)}
                                      className="w-4 h-4"
                                    />
                                  )}
                                  <label className={`font-semibold ${catDef.auto ? 'text-purple-600 italic' : 'text-gray-700'}`}>
                                    {catDef.label}
                                    {catDef.auto && <span className="text-xs ml-2">(auto-selected)</span>}
                                    {catDef.optional && <span className="text-xs ml-2 text-gray-500">(optional)</span>}
                                  </label>
                                </div>

                                {shouldShow && (
                                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                    {categoryItems.length === 0 ? (
                                      <div className="col-span-full text-sm text-gray-500 italic bg-yellow-50 p-3 rounded border border-yellow-200">
                                        No products in this category. Add them in the Database tab.
                                      </div>
                                    ) : (
                                      categoryItems.map(item => (
                                        <div
                                          key={item.id}
                                          onClick={() => !catDef.auto && handleSelection(option.id, catDef.key, item.id)}
                                          className={`border-2 rounded-lg p-3 cursor-pointer transition ${
                                            selectedItemId === item.id
                                              ? 'border-blue-500 bg-blue-50'
                                              : 'border-gray-300 hover:border-blue-300'
                                          } ${catDef.auto ? 'opacity-60 cursor-not-allowed' : ''}`}
                                        >
                                          {item.imageUrl && (
                                            <img src={item.imageUrl} alt={item.model} className="w-full h-32 object-cover rounded mb-2" />
                                          )}
                                          <div className="font-semibold text-sm">{item.brand}</div>
                                          <div className="text-sm text-gray-600">{item.model}</div>
                                          {item.series && <div className="text-xs text-gray-500 italic">{item.series}</div>}
                                          {item.description && (
                                            <div className="text-xs text-gray-600 mt-2 pt-2 border-t border-gray-200">
                                              {item.description}
                                            </div>
                                          )}
                                          <div className="text-sm font-bold text-blue-600 mt-2">{currency}{item.price?.toFixed(2) || '0.00'}</div>
                                        </div>
                                      ))
                                    )}
                                  </div>
                                )}
                              </div>
                            );
                          })}
                        </div>
                      </div>
                    ))}
                  </div>
                ))}
              </>
            )}
          </div>
        )}

        {/* FINAL SELECTIONS VIEW */}
        {view === 'final' && (
          <div className="space-y-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
              <div className="flex justify-between items-center mb-6">
                <div>
                  <h2 className="text-2xl font-bold text-gray-800">Final Selections</h2>
                  <p className="text-gray-600">Select one option per bathroom for your final procurement list</p>
                </div>
              </div>

              {bathrooms.length === 0 ? (
                <div className="text-center py-12 text-gray-500">
                  <p className="text-lg">No bathrooms configured yet.</p>
                  <button
                    onClick={() => setView('bathrooms')}
                    className="mt-4 bg-blue-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-600 transition"
                  >
                    Create Your First Bathroom
                  </button>
                </div>
              ) : (
                <>
                  {bathrooms.map(bathroom => (
                    <div key={bathroom.id} className="border-2 border-gray-200 rounded-lg p-6 mb-6">
                      <h3 className="text-xl font-bold mb-4 text-gray-800">{bathroom.name}</h3>
                      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        {bathroom.options.map(option => {
                          const isSelected = finalSelections[bathroom.id] === option.id;
                          return (
                            <div
                              key={option.id}
                              onClick={() => {
                                setFinalSelections({
                                  ...finalSelections,
                                  [bathroom.id]: option.id
                                });
                                setNotification({ type: 'success', message: `Selected ${option.name} for ${bathroom.name}` });
                                setTimeout(() => setNotification(null), 2000);
                              }}
                              className={`border-2 rounded-lg p-4 cursor-pointer transition ${
                                isSelected
                                  ? 'border-green-500 bg-green-50 shadow-lg'
                                  : 'border-gray-300 hover:border-blue-300 hover:shadow'
                              }`}
                            >
                              <div className="flex items-center mb-2">
                                {isSelected && <span className="text-2xl mr-2">‚úÖ</span>}
                                <h4 className="font-bold text-lg">{option.name}</h4>
                              </div>
                              <div className="text-sm text-gray-600 mb-2">
                                {Object.keys(option.selections || {}).length} items selected
                              </div>
                              <div className="text-lg font-bold text-blue-600">
                                {currency}{calculateOptionTotal(option).toFixed(2)}
                              </div>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  ))}

                  {Object.keys(finalSelections).length > 0 && (
                    <div className="bg-gradient-to-r from-yellow-50 to-orange-50 border-l-4 border-yellow-500 p-6 mt-6 rounded-lg">
                      <div className="flex justify-between items-center">
                        <div>
                          <p className="font-bold text-xl text-gray-800 mb-2">Total Project Cost</p>
                          <p className="text-sm text-gray-600">
                            Based on {Object.keys(finalSelections).length} selected option(s)
                          </p>
                        </div>
                        <p className="text-4xl text-blue-600 font-bold">
                          {currency}{Object.entries(finalSelections).reduce((total, [bathroomId, optionId]) => {
                            const bathroom = bathrooms.find(b => b.id === parseInt(bathroomId));
                            if (!bathroom) return total;
                            const option = bathroom.options.find(o => o.id === optionId);
                            if (!option) return total;
                            return total + calculateOptionTotal(option);
                          }, 0).toFixed(2)}
                        </p>
                      </div>
                      <div className="mt-4 flex gap-3">
                        <button
                          onClick={() => setView('procurement')}
                          className="bg-blue-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-blue-600 transition"
                        >
                          View Procurement Details ‚Üí
                        </button>
                        <button
                          onClick={() => setView('overview')}
                          className="bg-green-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-green-600 transition"
                        >
                          View Project Overview ‚Üí
                        </button>
                      </div>
                    </div>
                  )}
                </>
              )}
            </div>
          </div>
        )}

        {/* SUMMARY VIEW */}
        {view === 'summary' && (
          <div className="space-y-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
              <div className="flex justify-between items-center mb-6">
                <h2 className="text-2xl font-bold text-gray-800">Bathroom Comparison Summary</h2>
                <button
                  onClick={() => exportToPDF('Summary', 'summary-content')}
                  className="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition shadow-lg flex items-center gap-2"
                >
                  <Download className="w-5 h-5" /> Export PDF
                </button>
              </div>

              <div id="summary-content">
                {bathrooms.length === 0 ? (
                  <div className="text-center py-12 text-gray-500">
                    <p className="text-lg">No bathrooms configured yet.</p>
                  </div>
                ) : (
                  <div className="space-y-8">
                    {bathrooms.map(bathroom => (
                      <div key={bathroom.id} className="border-2 border-gray-200 rounded-lg p-6">
                        <h3 className="text-xl font-bold text-gray-800 mb-4 pb-3 border-b-2 border-gray-300">{bathroom.name}</h3>
                        
                        <div className="overflow-x-auto">
                          <table className="w-full border-collapse text-sm">
                            <thead>
                              <tr className="bg-gray-100">
                                <th className="border p-2 text-left">Category</th>
                                {bathroom.options.map(option => (
                                  <th key={option.id} className="border p-2 text-left">{option.name}</th>
                                ))}
                              </tr>
                            </thead>
                            <tbody>
                              {Object.entries(categoriesByZone).map(([zoneKey, zoneCategories]) => (
                                <React.Fragment key={zoneKey}>
                                  <tr className="bg-gradient-to-r from-blue-50 to-indigo-50">
                                    <td colSpan={bathroom.options.length + 1} className="border p-2 font-bold text-gray-800">
                                      {getZoneName(zoneKey)}
                                    </td>
                                  </tr>
                                  {zoneCategories.map(catDef => (
                                    <tr key={catDef.key} className="hover:bg-gray-50">
                                      <td className="border p-2 font-semibold">{catDef.label}</td>
                                      {bathroom.options.map(option => {
                                        const isIncluded = !catDef.optional || (option.includedOptionalItems || []).includes(catDef.key);
                                        const itemId = option.selections[catDef.key];
                                        const item = items.find(it => it.id === itemId);

                                        return (
                                          <td key={option.id} className="border p-2">
                                            {!isIncluded ? (
                                              <span className="text-gray-400 italic text-xs">Not included</span>
                                            ) : item ? (
                                              <div>
                                                <div className="font-semibold">{item.brand} {item.model}</div>
                                                {item.series && <div className="text-xs text-gray-600">{item.series}</div>}
                                                {showPrices && <div className="text-sm font-bold text-blue-600">{currency}{item.price?.toFixed(2)}</div>}
                                              </div>
                                            ) : (
                                              <span className="text-red-500 text-xs">Not selected</span>
                                            )}
                                          </td>
                                        );
                                      })}
                                    </tr>
                                  ))}
                                </React.Fragment>
                              ))}
                              <tr className="bg-yellow-100 font-bold">
                                <td className="border p-2">TOTAL</td>
                                {bathroom.options.map(option => (
                                  <td key={option.id} className="border p-2 text-lg text-blue-600">
                                    {currency}{calculateOptionTotal(option).toFixed(2)}
                                  </td>
                                ))}
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            </div>
          </div>
        )}

        {/* OVERVIEW VIEW */}
        {view === 'overview' && (
          <div className="space-y-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
              <div className="flex justify-between items-center mb-6">
                <h2 className="text-2xl font-bold text-gray-800">Project Overview</h2>
                <button
                  onClick={() => exportToPDF('Overview', 'overview-content')}
                  className="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition shadow-lg flex items-center gap-2"
                >
                  <Download className="w-5 h-5" /> Export PDF
                </button>
              </div>

              <div id="overview-content">
                {bathrooms.length === 0 ? (
                  <div className="text-center py-12 text-gray-500">
                    <p className="text-lg">No bathrooms configured yet.</p>
                  </div>
                ) : (
                  <div className="grid gap-6">
                    {bathrooms.map(bathroom => (
                      <div key={bathroom.id} className="border-2 border-gray-200 rounded-lg p-6">
                        <div className="flex justify-between items-start mb-4">
                          <div>
                            <h3 className="text-xl font-bold text-gray-800">{bathroom.name}</h3>
                            <div className="flex gap-3 mt-2 text-sm">
                              <span className="bg-gray-100 px-3 py-1 rounded">
                                Importance: {bathroom.importance === 'high' ? 'üî¥ High' : bathroom.importance === 'medium' ? 'üü° Medium' : 'üü¢ Low'}
                              </span>
                              <span className="bg-gray-100 px-3 py-1 rounded">
                                {bathroom.options.length} Options
                              </span>
                            </div>
                          </div>
                        </div>

                        {/* Renders */}
                        {bathroom.renders && bathroom.renders.length > 0 && (
                          <div className="mb-4 flex gap-2 flex-wrap">
                            {bathroom.renders.map((render, idx) => (
                              <img key={idx} src={render} alt={`Render ${idx + 1}`} className="w-32 h-32 object-cover rounded border" />
                            ))}
                          </div>
                        )}

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                          {bathroom.options.map(option => (
                            <div key={option.id} className="border rounded-lg p-4 bg-gray-50">
                              <h4 className="font-bold text-lg mb-3 text-gray-800">{option.name}</h4>
                              <div className="space-y-2 text-sm">
                                {Object.entries(categoriesByZone).map(([zoneKey, zoneCategories]) => {
                                  const zoneItems = zoneCategories
                                    .map(catDef => {
                                      const isIncluded = !catDef.optional || (option.includedOptionalItems || []).includes(catDef.key);
                                      const itemId = option.selections[catDef.key];
                                      const item = items.find(it => it.id === itemId);
                                      return { catDef, isIncluded, item };
                                    })
                                    .filter(x => x.isIncluded && x.item);

                                  if (zoneItems.length === 0) return null;

                                  return (
                                    <div key={zoneKey}>
                                      <div className="font-semibold text-blue-600 text-xs mb-1">{getZoneName(zoneKey)}</div>
                                      {zoneItems.map(({ catDef, item }) => (
                                        <div key={catDef.key} className="ml-2 text-xs text-gray-700">
                                          ‚Ä¢ <span className="font-semibold">{item.brand}</span> {item.model}
                                          {showPrices && <span className="text-blue-600 ml-1">({currency}{item.price?.toFixed(2)})</span>}
                                        </div>
                                      ))}
                                    </div>
                                  );
                                })}
                              </div>
                              <div className="mt-3 pt-3 border-t border-gray-300">
                                <div className="text-lg font-bold text-blue-600">
                                  Total: {currency}{calculateOptionTotal(option).toFixed(2)}
                                </div>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    ))}
                  </div>
                )}
              </div>
            </div>
          </div>
        )}

        {/* PROCUREMENT VIEW */}
        {view === 'procurement' && (
          <div className="space-y-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
              <div className="flex justify-between items-center mb-6">
                <h2 className="text-2xl font-bold text-gray-800">Procurement Details</h2>
                <div className="flex gap-2">
                  <button
                    onClick={exportProcurementToExcel}
                    className="bg-gradient-to-r from-green-500 to-emerald-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-green-600 hover:to-emerald-600 transition shadow-lg flex items-center gap-2"
                  >
                    <Download className="w-5 h-5" /> Export Excel
                  </button>
                  <button
                    onClick={() => exportToPDF('Procurement', 'procurement-content')}
                    className="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-purple-600 hover:to-pink-600 transition shadow-lg flex items-center gap-2"
                  >
                    <Download className="w-5 h-5" /> Export PDF
                  </button>
                </div>
              </div>

              <div id="procurement-content">
                {bathrooms.length === 0 ? (
                  <div className="text-center py-12 text-gray-500">
                    <p className="text-lg">No bathrooms configured yet.</p>
                  </div>
                ) : (
                  <div className="space-y-6">
                    {(() => {
                      const brandMap = {};
                      
                      bathrooms.forEach(bathroom => {
                        bathroom.options.forEach(option => {
                          const allCategories = getDefaultCategories();
                          
                          allCategories.forEach(catDef => {
                            const isIncluded = !catDef.optional || (option.includedOptionalItems || []).includes(catDef.key);
                            if (isIncluded) {
                              const itemId = option.selections[catDef.key];
                              if (itemId) {
                                const item = items.find(it => it.id === itemId);
                                if (item) {
                                  const key = `${item.brand}|||${item.model}`;
                                  if (!brandMap[key]) {
                                    brandMap[key] = {
                                      brand: item.brand,
                                      model: item.model,
                                      category: getCategoryName(item.category),
                                      price: item.price || 0,
                                      quantity: 0,
                                      imageUrl: item.imageUrl
                                    };
                                  }
                                  brandMap[key].quantity += 1;
                                }
                              }
                            }
                          });
                        });
                      });

                      const procurementData = Object.values(brandMap).sort((a, b) => {
                        if (a.brand !== b.brand) return a.brand.localeCompare(b.brand);
                        return a.model.localeCompare(b.model);
                      });

                      let grandTotal = 0;

                      return (
                        <div className="overflow-x-auto">
                          <table className="w-full border-collapse">
                            <thead>
                              <tr className="bg-gray-100">
                                <th className="border p-3 text-left">Image</th>
                                <th className="border p-3 text-left">Brand</th>
                                <th className="border p-3 text-left">Model</th>
                                <th className="border p-3 text-left">Category</th>
                                <th className="border p-3 text-left">Quantity</th>
                                <th className="border p-3 text-left">Unit Price</th>
                                <th className="border p-3 text-left">Total Price</th>
                              </tr>
                            </thead>
                            <tbody>
                              {procurementData.map((item, idx) => {
                                const totalPrice = item.quantity * item.price;
                                grandTotal += totalPrice;
                                
                                return (
                                  <tr key={idx} className="hover:bg-gray-50">
                                    <td className="border p-3">
                                      {item.imageUrl && (
                                        <img src={item.imageUrl} alt={item.model} className="w-16 h-16 object-cover rounded" />
                                      )}
                                    </td>
                                    <td className="border p-3 font-semibold">{item.brand}</td>
                                    <td className="border p-3">{item.model}</td>
                                    <td className="border p-3 text-sm text-gray-600">{item.category}</td>
                                    <td className="border p-3 text-center font-bold">{item.quantity}</td>
                                    <td className="border p-3 font-semibold">{currency}{item.price.toFixed(2)}</td>
                                    <td className="border p-3 font-bold text-blue-600">{currency}{totalPrice.toFixed(2)}</td>
                                  </tr>
                                );
                              })}
                              <tr className="bg-yellow-100">
                                <td colSpan="6" className="border p-3 text-right font-bold text-lg">GRAND TOTAL</td>
                                <td className="border p-3 font-bold text-xl text-blue-600">{currency}{grandTotal.toFixed(2)}</td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      );
                    })()}
                  </div>
                )}
              </div>
            </div>
          </div>
        )}

        {/* SETTINGS VIEW */}
        {view === 'settings' && (
          <div className="space-y-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
              <h2 className="text-2xl font-bold text-gray-800 mb-6">Settings</h2>
              
              <div className="space-y-6">
                {/* Data Management Section */}
                <div className="border-2 border-gray-200 rounded-lg p-6">
                  <h3 className="text-xl font-bold mb-4 text-gray-800">üíæ Data Management</h3>
                  
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div className="bg-blue-50 p-4 rounded-lg">
                      <div className="text-3xl font-bold text-blue-600">{items.length}</div>
                      <div className="text-sm text-gray-600">Products in Database</div>
                    </div>
                    <div className="bg-green-50 p-4 rounded-lg">
                      <div className="text-3xl font-bold text-green-600">{bathrooms.length}</div>
                      <div className="text-sm text-gray-600">Bathrooms Created</div>
                    </div>
                    <div className="bg-purple-50 p-4 rounded-lg">
                      <div className="text-3xl font-bold text-purple-600">
                        {bathrooms.reduce((sum, b) => sum + b.options.length, 0)}
                      </div>
                      <div className="text-sm text-gray-600">Total Options</div>
                    </div>
                  </div>

                  <div className="mb-4">
                    <p className="text-sm font-semibold mb-2">Storage Status:</p>
                    <div className={`px-4 py-2 rounded-lg ${storageAvailable ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
                      {storageAvailable ? '‚úì Auto-save enabled - Your data is being saved automatically' : '‚ö†Ô∏è Storage unavailable - Please use manual backup'}
                    </div>
                  </div>

                  <button
                    onClick={() => {
                      if (confirm('‚ö†Ô∏è WARNING: This will permanently delete ALL your data including:\n\n‚Ä¢ All products in database\n‚Ä¢ All bathrooms and configurations\n‚Ä¢ All custom categories\n‚Ä¢ Final selections\n‚Ä¢ Settings\n\nThis action CANNOT be undone!\n\nAre you absolutely sure you want to continue?')) {
                        clearStorage();
                        setItems([]);
                        setBathrooms([]);
                        setCustomCategories([]);
                        setFinalSelections({});
                        setSelectedBathroom(null);
                        setNotification({ type: 'success', message: 'All data cleared successfully!' });
                        setTimeout(() => setNotification(null), 3000);
                      }
                    }}
                    className="bg-red-500 text-white px-6 py-3 rounded-lg font-semibold hover:bg-red-600 transition shadow"
                  >
                    üóëÔ∏è Clear All Data
                  </button>
                  <p className="text-xs text-gray-500 mt-2 italic">
                    Warning: This will permanently delete all products, bathrooms, and configurations.
                  </p>
                </div>

                {/* Category Management */}
                <div className="border-2 border-gray-200 rounded-lg p-6">
                  <h3 className="text-xl font-bold mb-4 text-gray-800">Category Management</h3>
                  <p className="text-sm text-gray-600 mb-4">
                    Add custom categories for your specific needs beyond the default bathroom categories.
                  </p>
                  <button
                    onClick={() => setShowCategoryManager(true)}
                    className="bg-gradient-to-r from-blue-500 to-indigo-500 text-white px-6 py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-indigo-600 transition shadow"
                  >
                    üè∑Ô∏è Manage Categories
                  </button>
                  {customCategories.length > 0 && (
                    <div className="mt-4">
                      <p className="text-sm font-semibold text-gray-700 mb-2">Custom Categories ({customCategories.length}):</p>
                      <div className="flex flex-wrap gap-2">
                        {customCategories.map(cat => (
                          <span key={cat.key} className="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm">
                            {cat.label}
                          </span>
                        ))}
                      </div>
                    </div>
                  )}
                </div>

                {/* Currency Settings */}
                <div className="border-2 border-gray-200 rounded-lg p-6">
                  <h3 className="text-xl font-bold mb-4 text-gray-800">Currency Settings</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-semibold mb-2">Select Currency:</label>
                      <select
                        value={currencyCode}
                        onChange={(e) => setCurrencyFromCode(e.target.value)}
                        className="w-full border rounded px-3 py-2"
                      >
                        {currencyOptions.map(curr => (
                          <option key={curr.code} value={curr.code}>
                            {curr.symbol} - {curr.name} ({curr.code})
                          </option>
                        ))}
                      </select>
                    </div>
                    <div>
                      <label className="block text-sm font-semibold mb-2">Current Currency:</label>
                      <div className="bg-gray-100 border rounded px-3 py-2 font-bold text-lg">
                        {currency} ({currencyCode})
                      </div>
                    </div>
                  </div>
                  <p className="text-sm text-gray-500 mt-3 italic">
                    Note: Currency is cosmetic only and does not perform conversions. Enter all prices in your chosen currency.
                  </p>
                </div>

                {/* Price Display */}
                <div className="border-2 border-gray-200 rounded-lg p-6">
                  <h3 className="text-xl font-bold mb-4 text-gray-800">Display Settings</h3>
                  <div className="flex items-center gap-3">
                    <input
                      type="checkbox"
                      id="showPrices"
                      checked={showPrices}
                      onChange={(e) => setShowPrices(e.target.checked)}
                      className="w-5 h-5"
                    />
                    <label htmlFor="showPrices" className="font-semibold">
                      Show prices in summaries and overviews
                    </label>
                  </div>
                </div>

                {/* About Section */}
                <div className="border-2 border-gray-200 rounded-lg p-6">
                  <h3 className="text-xl font-bold mb-4 text-gray-800">‚ÑπÔ∏è About</h3>
                  
                  <div className="space-y-4 text-sm">
                    <div>
                      <p className="font-semibold text-gray-700">Version:</p>
                      <p className="text-gray-600">2.0.0 (January 2026)</p>
                    </div>

                    <div>
                      <p className="font-semibold text-gray-700">Created by:</p>
                      <a 
                        href="https://www.linkedin.com/in/poojasengupta/" 
                        target="_blank" 
                        rel="noopener noreferrer"
                        className="text-blue-600 hover:text-blue-800 font-semibold underline"
                      >
                        Pooja Sengupta
                      </a>
                      <p className="text-xs text-gray-500 mt-1">
                        Built with ‚ù§Ô∏è and Claude AI during a real bathroom renovation project
                      </p>
                    </div>

                    <div>
                      <p className="font-semibold text-gray-700 mb-2">Support this project:</p>
                      <a
                        href="https://buymeacoffee.com/poojasengupta"
                        target="_blank"
                        rel="noopener noreferrer"
                        className="inline-block"
                      >
                        <img 
                          src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" 
                          alt="Buy Me A Coffee" 
                          style={{height: '40px', width: 'auto'}}
                        />
                      </a>
                      <p className="text-xs text-gray-500 mt-2">
                        Your support helps maintain and improve this free tool!
                      </p>
                    </div>

                    <div>
                      <p className="font-semibold text-gray-700">License:</p>
                      <p className="text-gray-600">MIT License - Free to use, modify, and distribute</p>
                    </div>

                    <div>
                      <p className="font-semibold text-gray-700">Copyright:</p>
                      <p className="text-gray-600">¬© 2026 Pooja Sengupta. All rights reserved.</p>
                    </div>
                  </div>
                </div>

                {/* Debug Log */}
                <div className="border-2 border-gray-200 rounded-lg p-6">
                  <h3 className="text-xl font-bold mb-4 text-gray-800">Debug Log</h3>
                  <div className="bg-gray-900 text-green-400 p-4 rounded font-mono text-xs max-h-64 overflow-y-auto">
                    {log.map((entry, idx) => (
                      <div key={idx}>{entry}</div>
                    ))}
                  </div>
                  <button
                    onClick={() => setLog([])}
                    className="mt-2 bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600"
                  >
                    Clear Log
                  </button>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* HELP VIEW */}
        {view === 'help' && (
          <div className="bg-white rounded-lg shadow-lg p-8">
            <h2 className="text-3xl font-bold text-gray-800 mb-6">üìñ Help & Documentation</h2>
            
            <div className="space-y-6">
              {/* Quick Start */}
              <div className="bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg shadow p-6 border border-green-200">
                <h3 className="text-2xl font-bold mb-3 text-gray-800">üöÄ Quick Start Guide</h3>
                <p className="text-gray-700 mb-4">Get started in 4 easy steps:</p>
                <ol className="list-decimal list-inside space-y-2 text-gray-700">
                  <li><strong>Add Products:</strong> Go to <span className="bg-gray-200 px-2 py-1 rounded">Database</span> tab and add your bathroom products</li>
                  <li><strong>Create Bathrooms:</strong> Go to <span className="bg-gray-200 px-2 py-1 rounded">Bathrooms</span> tab and create your bathrooms</li>
                  <li><strong>Configure Options:</strong> Go to <span className="bg-gray-200 px-2 py-1 rounded">Configure</span> tab and select products for each option</li>
                  <li><strong>Compare:</strong> Use <span className="bg-gray-200 px-2 py-1 rounded">Summary</span> to compare options side-by-side</li>
                  <li><strong>Review:</strong> Use <span className="bg-gray-200 px-2 py-1 rounded">Overview</span> for a project-wide view</li>
                  <li><strong>Procure:</strong> Use <span className="bg-gray-200 px-2 py-1 rounded">Procurement</span> to get quantities by brand</li>
                </ol>
              </div>
              
              {/* Database Tab */}
              <div className="bg-white rounded-lg shadow p-6">
                <h3 className="text-xl font-bold mb-3">üìä Database Tab</h3>
                <p className="text-gray-700 mb-3">Add all your bathroom products here first.</p>
                <ul className="list-disc list-inside space-y-1 text-gray-600 text-sm">
                  <li><strong>Category:</strong> Choose from Basin Zone, WC Zone, Shower Zone, Accessories, or Tiles</li>
                  <li><strong>Brand & Model:</strong> Required fields</li>
                  <li><strong>Price:</strong> Enter unit price in your currency</li>
                  <li><strong>Image:</strong> Optional - upload or use URL</li>
                  <li><strong>Related Items:</strong> For auto-selection (e.g., diverter ‚Üí concealed body)</li>
                </ul>
              </div>
              
              {/* Bathrooms Tab */}
              <div className="bg-white rounded-lg shadow p-6">
                <h3 className="text-xl font-bold mb-3">üöø Bathrooms Tab</h3>
                <p className="text-gray-700 mb-3">Create your bathrooms and define how many options to compare.</p>
                <ul className="list-disc list-inside space-y-1 text-gray-600 text-sm">
                  <li><strong>Name:</strong> e.g., "Master Bathroom", "Guest Bath"</li>
                  <li><strong>Importance:</strong> High/Medium/Low for prioritization</li>
                  <li><strong>Number of Options:</strong> How many alternatives to compare (1-5)</li>
                  <li><strong>Renders:</strong> Upload bathroom renders/photos for reference</li>
                </ul>
              </div>
              
              {/* Configure Tab */}
              <div className="bg-white rounded-lg shadow p-6">
                <h3 className="text-xl font-bold mb-3">‚öôÔ∏è Configure Tab</h3>
                <p className="text-gray-700 mb-3">Select products for each option. Products are organized by zones.</p>
                <ul className="list-disc list-inside space-y-1 text-gray-600 text-sm">
                  <li><strong>Zones:</strong> Basin, WC, Shower, Accessories, Tiles</li>
                  <li><strong>Auto-selected items:</strong> Some items (like concealed bodies) auto-select</li>
                  <li><strong>Optional items:</strong> Check boxes to include (e.g., Geyser, Towel Rack)</li>
                  <li><strong>Add/Duplicate/Delete:</strong> Manage options easily</li>
                </ul>
              </div>
              
              {/* Export Features */}
              <div className="bg-white rounded-lg shadow p-6">
                <h3 className="text-xl font-bold mb-3">üì§ Export & Share</h3>
                <div className="space-y-3">
                  <div>
                    <h4 className="font-semibold text-gray-800">Export to PDF</h4>
                    <p className="text-sm text-gray-600">Available in Summary, Overview, and Procurement tabs. Click the purple "Export PDF" button, then use your browser's Print dialog to save as PDF.</p>
                  </div>
                  <div>
                    <h4 className="font-semibold text-gray-800">Export to Excel</h4>
                    <p className="text-sm text-gray-600">In Procurement tab, click "Export Excel" to download a spreadsheet with quantities and pricing.</p>
                  </div>
                  <div>
                    <h4 className="font-semibold text-gray-800">Backup Data</h4>
                    <p className="text-sm text-gray-600">In Database tab, use "Export Backup" to save all your data. Use "Import Backup" to restore.</p>
                  </div>
                </div>
              </div>
              
              {/* Tips & Tricks */}
              <div className="bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg shadow p-6 border border-yellow-200">
                <h3 className="text-xl font-bold mb-3">üí° Tips & Tricks</h3>
                <ul className="list-disc list-inside space-y-2 text-gray-700 text-sm">
                  <li><strong>Related Items:</strong> When adding a diverter, specify its concealed body in "Related Items" for auto-selection</li>
                  <li><strong>Multiple Options:</strong> Create 2-3 options per bathroom to compare budget vs premium choices</li>
                  <li><strong>Bulk Edit:</strong> In Database, select multiple items and edit them together</li>
                  <li><strong>Zones:</strong> Products are organized by zones for easier navigation</li>
                  <li><strong>Currency:</strong> Set your currency in Settings - it's cosmetic, enter prices in your own currency</li>
                  <li><strong>Save Often:</strong> Use Export Backup regularly to save your work</li>
                </ul>
              </div>
              
              {/* Troubleshooting */}
              <div className="bg-white rounded-lg shadow p-6">
                <h3 className="text-xl font-bold mb-3">üîß Troubleshooting</h3>
                <div className="space-y-3 text-sm">
                  <div>
                    <h4 className="font-semibold text-gray-800">PDF Export Not Working?</h4>
                    <p className="text-gray-600">Enable popups for this site. The export opens in a new window which may be blocked by your browser.</p>
                  </div>
                  <div>
                    <h4 className="font-semibold text-gray-800">Data Not Saving?</h4>
                    <p className="text-gray-600">If storage is unavailable, use "Export Backup" button to save your data manually. You can restore it later with "Import Backup".</p>
                  </div>
                  <div>
                    <h4 className="font-semibold text-gray-800">Can't See My Images?</h4>
                    <p className="text-gray-600">If using URLs, make sure the image URL is publicly accessible. Try uploading the image directly instead.</p>
                  </div>
                </div>
              </div>

              {/* Support This Project */}
              <div className="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg shadow p-6 border border-purple-200">
                <h3 className="text-xl font-bold mb-3">‚òï Support This Project</h3>
                <p className="text-gray-700 mb-4">
                  This tool is completely free and open-source. If it helped you save time and sanity 
                  during your bathroom renovation, consider buying me a coffee!
                </p>
                <a
                  href="https://buymeacoffee.com/poojasengupta"
                  target="_blank"
                  rel="noopener noreferrer"
                  className="inline-block"
                >
                  <img 
                    src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" 
                    alt="Buy Me A Coffee" 
                    style={{height: '50px', width: 'auto'}}
                  />
                </a>
                <p className="text-xs text-gray-500 mt-3">
                  Your support helps maintain and improve this tool for everyone!
                </p>
              </div>
            </div>
          </div>
        )}

        {/* Category Manager Modal */}
      {showCategoryManager && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-lg p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div className="flex justify-between items-center mb-6">
              <h3 className="text-2xl font-bold text-gray-800">Category Manager</h3>
              <button
                onClick={() => setShowCategoryManager(false)}
                className="text-gray-500 hover:text-gray-700 text-2xl"
              >
                ‚úï
              </button>
            </div>

            {/* Add New Category Form */}
            <div className="bg-blue-50 border-2 border-blue-200 rounded-lg p-4 mb-6">
              <h4 className="font-bold text-gray-800 mb-3">Add New Category</h4>
              <form
                onSubmit={(e) => {
                  e.preventDefault();
                  const formData = new FormData(e.target);
                  const newCategory = {
                    key: formData.get('key').toLowerCase().replace(/\s+/g, '_'),
                    label: formData.get('label'),
                    zone: formData.get('zone'),
                    order: customCategories.filter(c => c.zone === formData.get('zone')).length + 1,
                    auto: formData.get('auto') === 'on',
                    optional: formData.get('optional') === 'on',
                    custom: true
                  };
                  
                  // Check if key already exists
                  const allCats = getDefaultCategories();
                  if (allCats.some(c => c.key === newCategory.key)) {
                    setNotification({ type: 'error', message: 'Category with this key already exists!' });
                    setTimeout(() => setNotification(null), 3000);
                    return;
                  }
                  
                  setCustomCategories([...customCategories, newCategory]);
                  setNotification({ type: 'success', message: 'Category added!' });
                  setTimeout(() => setNotification(null), 3000);
                  e.target.reset();
                }}
                className="grid grid-cols-1 md:grid-cols-2 gap-3"
              >
                <div>
                  <label className="block text-sm font-semibold mb-1">Category Name *</label>
                  <input
                    type="text"
                    name="label"
                    required
                    className="w-full border rounded px-3 py-2"
                    placeholder="e.g., Mirror Cabinet"
                  />
                </div>
                <div>
                  <label className="block text-sm font-semibold mb-1">Key (auto-generated)</label>
                  <input
                    type="text"
                    name="key"
                    required
                    className="w-full border rounded px-3 py-2"
                    placeholder="e.g., mirror_cabinet"
                  />
                </div>
                <div>
                  <label className="block text-sm font-semibold mb-1">Zone *</label>
                  <select name="zone" required className="w-full border rounded px-3 py-2">
                    <option value="basin_zone">Basin Zone</option>
                    <option value="wc_zone">WC Zone</option>
                    <option value="shower_zone">Shower Zone</option>
                    <option value="accessories_zone">Accessories</option>
                    <option value="tiles_zone">Tiles</option>
                    <option value="custom_zone">Custom Zone</option>
                  </select>
                </div>
                <div className="flex items-center gap-4 pt-6">
                  <label className="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" name="auto" className="w-4 h-4" />
                    <span className="text-sm font-semibold">Auto-select</span>
                  </label>
                  <label className="flex items-center gap-2 cursor-pointer">
                    <input type="checkbox" name="optional" className="w-4 h-4" />
                    <span className="text-sm font-semibold">Optional</span>
                  </label>
                </div>
                <div className="md:col-span-2">
                  <button
                    type="submit"
                    className="bg-green-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-green-600 transition"
                  >
                    ‚ûï Add Category
                  </button>
                </div>
              </form>
            </div>

            {/* Custom Categories List */}
            <div>
              <h4 className="font-bold text-gray-800 mb-3">Your Custom Categories</h4>
              {customCategories.length === 0 ? (
                <p className="text-gray-500 text-sm italic">No custom categories yet. Add one above!</p>
              ) : (
                <div className="space-y-2">
                  {customCategories.map(cat => (
                    <div key={cat.key} className="border rounded-lg p-3 flex justify-between items-center">
                      <div>
                        <div className="font-semibold">{cat.label}</div>
                        <div className="text-xs text-gray-600">
                          Zone: {cat.zone.replace('_zone', '').replace('_', ' ')} ‚Ä¢ 
                          {cat.auto && ' Auto-select ‚Ä¢'}
                          {cat.optional && ' Optional'}
                        </div>
                      </div>
                      <button
                        onClick={() => {
                          if (confirm(`Delete category "${cat.label}"? This will not affect existing products.`)) {
                            setCustomCategories(customCategories.filter(c => c.key !== cat.key));
                            setNotification({ type: 'success', message: 'Category deleted!' });
                            setTimeout(() => setNotification(null), 3000);
                          }
                        }}
                        className="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600"
                      >
                        Delete
                      </button>
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>
        </div>
      )}

      {/* Footer */}
        <footer className="mt-12 border-t border-gray-300 pt-6 pb-8 px-6 bg-gradient-to-r from-blue-50 to-indigo-50">
          <div className="max-w-4xl mx-auto text-center">
            <div className="mb-4">
              <p className="text-sm text-gray-700 leading-relaxed mb-3">
                üè† <em>Born from the chaos of DIY house construction ‚Äì when spreadsheets just weren't cutting it anymore.</em> üè†
              </p>
              <p className="text-sm text-gray-600 leading-relaxed">
                What started as a desperate attempt to organize bathroom fittings for my own home renovation 
                turned into this tinkering tool. If you're also drowning in product catalogs and trying to compare 
                15 different basin options, I hope this helps you too!
              </p>
            </div>

            <div className="mt-6 pt-6 border-t border-gray-300">
              <p className="text-sm text-gray-700 mb-3">
                ‚òï Enjoying this free tool? Support its development!
              </p>
              <a
                href="https://buymeacoffee.com/poojasengupta"
                target="_blank"
                rel="noopener noreferrer"
                className="inline-block"
              >
                <img 
                  src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" 
                  alt="Buy Me A Coffee" 
                  style={{height: '50px', width: 'auto'}}
                />
              </a>
            </div>
            
            <div className="mt-4 pt-4 border-t border-gray-300">
              <p className="text-sm text-gray-700">
                Created with ‚ù§Ô∏è by{' '}
                <a 
                  href="https://www.linkedin.com/in/poojasengupta/" 
                  target="_blank" 
                  rel="noopener noreferrer"
                  className="text-blue-600 hover:text-blue-800 font-semibold underline"
                >
                  Pooja Sengupta
                </a>
                {' '}and{' '}
                <span className="font-semibold text-purple-600">Claude AI</span>
              </p>
              <p className="text-xs text-gray-500 mt-2">
                ¬© 2026 ‚Ä¢ Built with React ‚Ä¢ May your bathroom renovations be less stressful than mine! ‚ú®
              </p>
            </div>
          </div>
        </footer>
      </div>

      {/* Delete Confirmation Modal */}
      {deleteConfirm && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white rounded-lg p-6 max-w-md">
            <h3 className="text-xl font-bold mb-4">Confirm Deletion</h3>
            <p className="mb-6">Are you sure you want to delete this item? This cannot be undone.</p>
            <div className="flex gap-3 justify-end">
              <button
                onClick={() => setDeleteConfirm(null)}
                className="bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400"
              >
                Cancel
              </button>
              <button
                onClick={() => deleteItem(deleteConfirm)}
                className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"
              >
                Delete
              </button>
            </div>
          </div>
        </div>
      )}

      {/* Delete Option Confirmation Modal */}
      {deleteConfirmOption && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <div className="bg-white rounded-lg p-6 max-w-md">
            <h3 className="text-xl font-bold mb-4">Confirm Deletion</h3>
            <p className="mb-6">Are you sure you want to delete this option? This cannot be undone.</p>
            <div className="flex gap-3 justify-end">
              <button
                onClick={() => setDeleteConfirmOption(null)}
                className="bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400"
              >
                Cancel
              </button>
              <button
                onClick={() => deleteOption(selectedBathroom.id, deleteConfirmOption)}
                className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"
              >
                Delete
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>